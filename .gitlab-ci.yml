# This file is a template, and might need editing before it works on your project.
# This is a sample GitLab CI/CD configuration file that should run without any modifications.
# It demonstrates a basic 3 stage CI/CD pipeline. Instead of real tests or scripts,
# it uses echo commands to simulate the pipeline execution.
#
# A pipeline is composed of independent jobs that run scripts, grouped into stages.
# Stages run in sequential order, but jobs within stages run in parallel.
#
#

# Use Node.js LTS as the Docker image for building the app
image: node:20.10.0

# Install dependencies and Angular CLI before running the build script
before_script:
  - npm install
  - npm install -g @angular/cli@17.0.8
# Define the build script for the pages
pages:
  script:
    - ng build --aot --progress --configuration=production --output-path=.
    - echo "/* /index.html 200" >> ./public/_redirects
  artifacts:
    paths:
      - public  # Expose the 'public' folder at the Page URL
  rules:
    - if: $CI_COMMIT_REF_NAME == $CI_DEFAULT_BRANCH  # Deploy only on pushes to the default branch
